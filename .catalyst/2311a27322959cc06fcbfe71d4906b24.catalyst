{"title":{"en":"C. Inheritance","ru":"C. Inheritance"},"contestId":"353907","problemIndex":"C","timeLimit":{"en":"1 second","ru":"1 second"},"memLimit":{"en":"256 megabytes","ru":"256 megabytes"},"inputFormat":{"en":"standard input","ru":"standard input"},"outputFormat":{"en":"standard output","ru":"standard output"},"problemHtml":{"en":"<p>Mr. JOI, the millionare who owns all of the IOI kingdom's railways, has passed away. According to his will, the railways are to be divided among his children.</p><p>There are $$$N$$$ cities in the IOI kingdom, numbered from $$$1$$$ to $$$N$$$. There are $$$M$$$ railways connecting the cities, numbered from $$$1$$$ to $$$M$$$. Railway $$$i$$$ connects cities $$$A_i$$$ and city $$$B_i$$$ in both directions, and produces a profit of $$$C_i$$$ yen in one year. $$$C_i$$$, ..., $$$C_M$$$ are all pairwise distinct because some railways are used more by passengers and railways also have different operating costs. There might be more than one railway connecting two cities.</p><p>Mr. JOI's will gave the following instructions on the distribution of his railway:</p><ul> <li> The railways are to be distributed to the $$$K$$$ children of Mr. JOI. The children are numbered from $$$1$$$ to $$$K$$$ in decreasing order of age. </li><li> Each child can pick any subset of the $$$M$$$ railways (even an empty subset). </li><li> Child $$$1$$$ picks the subset of the $$$M$$$ railways that he or she desires first. The remaining railways are left for Child $$$2$$$. Child $$$2$$$ then picks a subset of the railways, and so on. The $$$K$$$ children pick their railways in this order. </li><li> A child cannot pick a railway already previously chosen by one of his siblings. In other words, if child $$$j$$$ has chosen railway $$$i$$$, all children $$$k$$$ ($$$k$$$ &gt; $$$j$$$) are not allowed to choose railway i. </li><li> A child cannot pick a set of railways that contains a cycle. In other words, if in a subset $$$i_1$$$, $$$i_2$$$, ..., $$$i_m$$$ ($$$i_1$$$, $$$i_2$$$, ..., $$$i_m$$$ are distinct) of $$$m$$$ railways there exists a way to leave from one city and return to it, using only the railways in the subset each at most once, then no child is allowed to choose that subset of railways. </li><li> The rest of the remaining railways are to be donated to the IOI kingdom. </li></ul><p>Every child is greedy just like their father and will pick railways such that the total annual profit of his or her inheritance is as large as possible. The total annual profit of a set of railways is the sum of the annual profit for each railway in the set. For each child, the choice of railways that maximises his or her total annual profit is unique. For each railway, determine who it is distributed to.</p><p>Given information about the IOI kingdom's railways and the number of children Mr. JOI had, write a program to find the eventual ownership of each railway.</p>","ru":"<p>Mr. JOI, the millionare who owns all of the IOI kingdom's railways, has passed away. According to his will, the railways are to be divided among his children.</p><p>There are $$$N$$$ cities in the IOI kingdom, numbered from $$$1$$$ to $$$N$$$. There are $$$M$$$ railways connecting the cities, numbered from $$$1$$$ to $$$M$$$. Railway $$$i$$$ connects cities $$$A_i$$$ and city $$$B_i$$$ in both directions, and produces a profit of $$$C_i$$$ yen in one year. $$$C_i$$$, ..., $$$C_M$$$ are all pairwise distinct because some railways are used more by passengers and railways also have different operating costs. There might be more than one railway connecting two cities.</p><p>Mr. JOI's will gave the following instructions on the distribution of his railway:</p><ul> <li> The railways are to be distributed to the $$$K$$$ children of Mr. JOI. The children are numbered from $$$1$$$ to $$$K$$$ in decreasing order of age. </li><li> Each child can pick any subset of the $$$M$$$ railways (even an empty subset). </li><li> Child $$$1$$$ picks the subset of the $$$M$$$ railways that he or she desires first. The remaining railways are left for Child $$$2$$$. Child $$$2$$$ then picks a subset of the railways, and so on. The $$$K$$$ children pick their railways in this order. </li><li> A child cannot pick a railway already previously chosen by one of his siblings. In other words, if child $$$j$$$ has chosen railway $$$i$$$, all children $$$k$$$ ($$$k$$$ &gt; $$$j$$$) are not allowed to choose railway i. </li><li> A child cannot pick a set of railways that contains a cycle. In other words, if in a subset $$$i_1$$$, $$$i_2$$$, ..., $$$i_m$$$ ($$$i_1$$$, $$$i_2$$$, ..., $$$i_m$$$ are distinct) of $$$m$$$ railways there exists a way to leave from one city and return to it, using only the railways in the subset each at most once, then no child is allowed to choose that subset of railways. </li><li> The rest of the remaining railways are to be donated to the IOI kingdom. </li></ul><p>Every child is greedy just like their father and will pick railways such that the total annual profit of his or her inheritance is as large as possible. The total annual profit of a set of railways is the sum of the annual profit for each railway in the set. For each child, the choice of railways that maximises his or her total annual profit is unique. For each railway, determine who it is distributed to.</p><p>Given information about the IOI kingdom's railways and the number of children Mr. JOI had, write a program to find the eventual ownership of each railway.</p>"},"inSpecsHtml":{"en":"<div class=\"section-title\">Input</div><ul> <li> On line 1, there are three space-separated integers $$$N$$$, $$$M$$$, $$$K$$$. These represent the number $$$N$$$ of cities and the number $$$M$$$ of railways in the IOI kingdom, and the number of children $$$K$$$ of Mr. JOI. </li><li> On the $$$i$$$th line of the following $$$M$$$ lines, there are three space-separated integers $$$A_i$$$, $$$B_i$$$, $$$C_i$$$. This means that railway $$$i$$$ connects cities $$$A_i$$$ and $$$B_i$$$ and produces a profit of $$$C_i$$$ yen in one year. </li></ul><p>All input data satisfies following constraints:</p><ul> <li> $$$2 \\leq N \\leq 1 000$$$. </li><li> $$$1 \\leq M \\leq 300 000$$$. </li><li> $$$1 \\leq K \\leq 10 000$$$. </li><li> $$$1 \\leq A_i \\leq N, 1 \\leq B_i \\leq N (1 \\leq i \\leq M$$$). </li><li> $$$A_i \\neq B_i (1 \\leq i \\leq M)$$$. </li><li> $$$1 \\leq C_i \\leq 1 000 000 000 (1 \\leq i \\leq M)$$$. </li><li> $$$C_i \\neq C_j (1 \\leq i &lt; j \\leq M)$$$. </li></ul>","ru":"<div class=\"section-title\">Input</div><ul> <li> On line 1, there are three space-separated integers $$$N$$$, $$$M$$$, $$$K$$$. These represent the number $$$N$$$ of cities and the number $$$M$$$ of railways in the IOI kingdom, and the number of children $$$K$$$ of Mr. JOI. </li><li> On the $$$i$$$th line of the following $$$M$$$ lines, there are three space-separated integers $$$A_i$$$, $$$B_i$$$, $$$C_i$$$. This means that railway $$$i$$$ connects cities $$$A_i$$$ and $$$B_i$$$ and produces a profit of $$$C_i$$$ yen in one year. </li></ul><p>All input data satisfies following constraints:</p><ul> <li> $$$2 \\leq N \\leq 1 000$$$. </li><li> $$$1 \\leq M \\leq 300 000$$$. </li><li> $$$1 \\leq K \\leq 10 000$$$. </li><li> $$$1 \\leq A_i \\leq N, 1 \\leq B_i \\leq N (1 \\leq i \\leq M$$$). </li><li> $$$A_i \\neq B_i (1 \\leq i \\leq M)$$$. </li><li> $$$1 \\leq C_i \\leq 1 000 000 000 (1 \\leq i \\leq M)$$$. </li><li> $$$C_i \\neq C_j (1 \\leq i &lt; j \\leq M)$$$. </li></ul>"},"outSpecsHtml":{"en":"<div class=\"section-title\">Output</div><p>There will be $$$M$$$ lines of output. On the $$$i$$$th line, print the number of the child to whom railway $$$i$$$ was given. Print $$$0$$$ if it was donated to the IOI kingdom.</p>","ru":"<div class=\"section-title\">Output</div><p>There will be $$$M$$$ lines of output. On the $$$i$$$th line, print the number of the child to whom railway $$$i$$$ was given. Print $$$0$$$ if it was donated to the IOI kingdom.</p>"},"noteHtml":{"en":null,"ru":null},"sampleTestcases":[{"id":1636588864807,"input":"3 5 2\n1 2 3\n1 2 1\n2 3 4\n2 3 6\n1 3 2\n","output":"1\n0\n2\n1\n2\n"},{"id":1636588864808,"input":"3 6 5\n1 2 1\n1 2 2\n2 3 3\n2 3 4\n3 1 5\n3 1 6\n","output":"4\n3\n2\n1\n2\n1\n"}],"submitUrl":"https://codeforces.com/group/KIrM1Owd8u/contest/353907/submit","language":"c++","isPartOfContest":true}