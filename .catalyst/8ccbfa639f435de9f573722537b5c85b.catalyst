{"title":{"en":"G. Kuzya and Homework","ru":"G. Кузя и домашнее задание"},"contestId":"1582","problemIndex":"G","timeLimit":{"en":"2 seconds","ru":"2 секунды"},"memLimit":{"en":"\n      512 megabytes","ru":"512 мегабайт"},"inputFormat":{"en":"\n      standard input","ru":"стандартный ввод"},"outputFormat":{"en":"\n      standard output","ru":"стандартный вывод"},"problemHtml":{"en":"\n    <p>Kuzya started going to school. He was given math homework in\n      which he was given an array $$$a$$$ of length $$$n$$$ and an array\n      of symbols $$$b$$$ of length $$$n$$$, consisting of symbols '*'\n      and '/'.</p>\n    <p>Let's denote a <span class=\"tex-font-style-it\">path of\n      calculations</span> for a segment $$$[l; r]$$$ ($$$1 \\le l \\le r\n      \\le n$$$) in the following way: </p>\n    <ul> <li> Let $$$x=1$$$ initially. For every $$$i$$$ from $$$l$$$ to\n        $$$r$$$ we will consequently do the following: if $$$b_i=$$$\n        '*', $$$x=x*a_i$$$, and if $$$b_i=$$$ '/', then\n        $$$x=\\frac{x}{a_i}$$$. Let's call <span class=\"tex-font-style-it\">a path of calculations</span> for\n        the segment $$$[l; r]$$$ a list of all $$$x$$$ that we got\n        during the calculations (the number of them is exactly $$$r - l\n        + 1$$$). </li></ul>\n    <p>For example, let $$$a=[7,$$$ $$$12,$$$ $$$3,$$$ $$$5,$$$ $$$4,$$$\n      $$$10,$$$ $$$9]$$$, $$$b=[/,$$$ $$$*,$$$ $$$/,$$$ $$$/,$$$\n      $$$/,$$$ $$$*,$$$ $$$*]$$$, $$$l=2$$$, $$$r=6$$$, then the path of\n      calculations for that segment is $$$[12,$$$ $$$4,$$$ $$$0.8,$$$\n      $$$0.2,$$$ $$$2]$$$.</p>\n    <p>Let's call a segment $$$[l;r]$$$ <span class=\"tex-font-style-it\">simple</span> if the path of\n      calculations for it contains <span class=\"tex-font-style-bf\">only\n        integer numbers</span>. </p>\n    <p>Kuzya needs to find the number of simple segments $$$[l;r]$$$\n      ($$$1 \\le l \\le r \\le n$$$). Since he obviously has no time and no\n      interest to do the calculations for each option, he asked you to\n      write a program to get to find that number!</p>","ru":"<p>Кузя начал ходить в школу. На уроке математики ему дали домашнее задание. Для этого задания ему выдали массив натуральных чисел $$$a$$$ длины $$$n$$$ и массив символов $$$b$$$ длины $$$n$$$, состоящий только из символов '*' или '/'.</p><p>Давайте определим <span class=\"tex-font-style-it\">траекторию вычислений</span> для отрезка $$$[l; r]$$$ ($$$1 \\le l \\le r \\le n$$$) следующим образом: </p><ul> <li> Пусть изначально $$$x=1$$$. Для всех $$$i$$$ от $$$l$$$ до $$$r$$$ последовательно выполним следующее: если $$$b_i=$$$ '*', $$$x=x*a_i$$$, а если $$$b_i=$$$ '/', то $$$x=\\frac{x}{a_i}$$$. <span class=\"tex-font-style-it\">Траекторией вычисления</span> для отрезка $$$[l; r]$$$ назовем список всех $$$x$$$, которые были получены в процессе вычислений (их будет ровно $$$r - l + 1$$$). </li></ul><p>Например, пусть $$$a=[7,$$$ $$$12,$$$ $$$3,$$$ $$$5,$$$ $$$4,$$$ $$$10,$$$ $$$9]$$$, $$$b=[/,$$$ $$$*,$$$ $$$/,$$$ $$$/,$$$ $$$/,$$$ $$$*,$$$ $$$*]$$$, $$$l=2$$$, $$$r=6$$$, тогда траектория вычислений для этого отрезка — это $$$[12,$$$ $$$4,$$$ $$$0.8,$$$ $$$0.2,$$$ $$$2]$$$.</p><p>Давайте назовем отрезок $$$[l;r]$$$ <span class=\"tex-font-style-it\">простым</span>, если траектория вычислений для него содержит <span class=\"tex-font-style-bf\">только целые числа</span>. </p><p>Кузе нужно посчитать количество простых отрезков $$$[l;r]$$$ ($$$1 \\le l \\le r \\le n$$$). Так как у него явно нет ни времени, ни желания проводить вычисления для всех вариантов, он попросил вас написать программу, чтобы узнать это количество!</p>"},"inSpecsHtml":{"en":"\n    <div class=\"section-title\">Input</div>\n    <p>The first line contains a single integer $$$n$$$ ($$$2 \\le n \\le 10^6$$$).</p>\n    <p>The second line contains $$$n$$$ integers $$$a_1, a_2, \\ldots,\n      a_n$$$ ($$$1 \\le a_i \\le 10^6$$$).</p>\n    <p>The third line contains $$$n$$$ symbols without spaces between\n      them — the array $$$b_1, b_2 \\ldots b_n$$$ ($$$b_i=$$$ '/' or\n      $$$b_i=$$$ '*' for every $$$1 \\le i \\le n$$$).</p>","ru":"<div class=\"section-title\">Входные данные</div><p>Первая строка содержит единственное целое число $$$n$$$ ($$$2 \\le n \\le 10^6$$$).</p><p>Вторая строка содержит $$$n$$$ целых чисел $$$a_1, a_2, \\ldots, a_n$$$ ($$$1 \\le a_i \\le 10^6$$$).</p><p>Третья строка содержит $$$n$$$ символов без пробелов между ними — массив $$$b_1, b_2 \\ldots b_n$$$ ($$$b_i=$$$ '/' или $$$b_i=$$$ '*' для всех $$$1 \\le i \\le n$$$).</p>"},"outSpecsHtml":{"en":"\n    <div class=\"section-title\">Output</div>\n    <p>Print a single integer — the number of simple segments $$$[l;r]$$$.</p>","ru":"<div class=\"section-title\">Выходные данные</div><p>В единственной строке выведите одно целое число — количество простых отрезков $$$[l;r]$$$.</p>"},"noteHtml":{"en":null,"ru":null},"sampleTestcases":[{"id":1635089939413,"input":"3\n1 2 3\n*/*","output":"2\n","result":{"id":1635089939413,"stdout":"2\n","stderr":"","exitcode":0,"signal":null,"time":2,"timeout":false}},{"id":1635089939414,"input":"7\n6 4 10 1 2 15 1\n*/*/*//","output":"8\n","result":{"id":1635089939414,"stdout":"8\n","stderr":"","exitcode":0,"signal":null,"time":4,"timeout":false}},{"id":1635095034810,"input":"3\n4 2 2\n*/*","output":"4","result":{"id":1635095034810,"stdout":"4\n","stderr":"","exitcode":0,"signal":null,"time":1,"timeout":false}},{"id":1635095392598,"input":"6\n1 9 3 4 2 6\n**/*//","output":"13","result":{"id":1635095392598,"stdout":"13\n","stderr":"","exitcode":0,"signal":null,"time":4,"timeout":false}},{"id":1635098248022,"input":"3\n9 4 3\n*//","output":"1","result":{"id":1635098248022,"stdout":"1\n","stderr":"","exitcode":0,"signal":null,"time":4,"timeout":false}},{"id":1635098763295,"input":"5\n1 1 1 1 1\n/*/**","output":"15","result":{"id":1635098763295,"stdout":"15\n","stderr":"","exitcode":0,"signal":null,"time":6,"timeout":false}},{"id":1635098784871,"input":"3\n1000000 1000000 1000000\n**/","output":"5","result":{"id":1635098784871,"stdout":"5\n","stderr":"","exitcode":0,"signal":null,"time":4,"timeout":false}},{"id":1635099322978,"input":"2\r\n1000000 100000\r\n*/","output":"2","result":{"id":1635099322978,"stdout":"2\n","stderr":"","exitcode":0,"signal":null,"time":1,"timeout":false}}],"submitUrl":"https://codeforces.com/contest/1582/submit","language":"c++","isPartOfContest":true,"langId":"54"}