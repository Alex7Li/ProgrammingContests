{"title":{"en":"C. Extreme Extension","ru":"C. Экстремальное удлинение"},"contestId":"1603","problemIndex":"C","timeLimit":{"en":"4 seconds","ru":"4 секунды"},"memLimit":{"en":"256 megabytes","ru":"256 мегабайт"},"inputFormat":{"en":"standard input","ru":"стандартный ввод"},"outputFormat":{"en":"standard output","ru":"стандартный вывод"},"problemHtml":{"en":"<p>For an array $$$b$$$ of $$$n$$$ integers, the <span class=\"tex-font-style-it\">extreme value</span> of this array is the minimum number of times (possibly, zero) the following operation has to be performed to make $$$b$$$ <span class=\"tex-font-style-bf\">non-decreasing</span>: </p><ul> <li> Select an index $$$i$$$ such that $$$1 \\le i \\le |b|$$$, where $$$|b|$$$ is the current length of $$$b$$$. </li><li> Replace $$$b_i$$$ with two elements $$$x$$$ and $$$y$$$ such that $$$x$$$ and $$$y$$$ both are <span class=\"tex-font-style-bf\">positive</span> integers and $$$x + y = b_i$$$. </li><li> This way, the array $$$b$$$ changes and the next operation is performed on this modified array. </li></ul><p>For example, if $$$b = [2, 4, 3]$$$ and index $$$2$$$ gets selected, then the possible arrays after this operation are $$$[2, \\underline{1}, \\underline{3}, 3]$$$, $$$[2, \\underline{2}, \\underline{2}, 3]$$$, or $$$[2, \\underline{3}, \\underline{1}, 3]$$$. And consequently, for this array, this single operation is enough to make it non-decreasing: $$$[2, 4, 3] \\rightarrow [2, \\underline{2}, \\underline{2}, 3]$$$.</p><p>It's easy to see that every array of positive integers can be made non-decreasing this way.</p><p>YouKn0wWho has an array $$$a$$$ of $$$n$$$ integers. Help him find the sum of <span class=\"tex-font-style-it\">extreme values</span> of all nonempty subarrays of $$$a$$$ modulo $$$998\\,244\\,353$$$. If a subarray appears in $$$a$$$ multiple times, its extreme value should be counted the number of times it appears.</p><p>An array $$$d$$$ is a subarray of an array $$$c$$$ if $$$d$$$ can be obtained from $$$c$$$ by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end.</p>","ru":"<p>Для массива $$$b$$$ из $$$n$$$ целых чисел определим <span class=\"tex-font-style-it\">экстремальное значение</span> этого массива как минимальное количество раз (возможно, нулевое), которое необходимо выполнить следующую операцию, чтобы массив $$$b$$$ стал <span class=\"tex-font-style-bf\">неубывающим</span>: </p><ul> <li> Выберите индекс $$$i$$$ такой, что $$$1 \\le i \\le |b|$$$, где $$$|b|$$$ — текущая длина $$$b$$$. </li><li> Замените $$$b_i$$$ двумя элементами $$$x$$$ и $$$y$$$ такими, что $$$x$$$ и $$$y$$$ являются целыми <span class=\"tex-font-style-bf\">положительными</span> числами и $$$x + y = b_i$$$. </li><li> Таким образом, массив $$$b$$$ изменяется, и следующая операция выполняется над этим измененным массивом. </li></ul><p>Например, если $$$b = [2, 4, 3]$$$ и выбран индекс $$$2$$$, то возможными массивами после этой операции будут $$$[2, \\underline{1}, \\underline{3}, 3]$$$, $$$[2, \\underline{2}, \\underline{2}, 3]$$$, или $$$[2, \\underline{3}, \\underline{1}, 3]$$$. И, следовательно, для этого массива достаточно одной операции, чтобы он стал неубывающим: $$$[2, 4, 3] \\rightarrow [2, \\underline{2}, \\underline{2}, 3]$$$.</p><p>Легко понять, что любой массив целых положительных чисел можно сделать неубывающим таким образом.</p><p>У YouKn0wWho есть массив $$$a$$$ из $$$n$$$ целых чисел. Помогите ему найти сумму <span class=\"tex-font-style-it\">экстремальных значений</span> по всем непустым подмассивам массива $$$a$$$ по модулю $$$998\\,244\\,353$$$. Если некоторый подмассив встречается в $$$a$$$ несколько раз, его экстремальное значение нужно учесть столько раз, сколько он встречается.</p><p>Массив $$$d$$$ является подмассивом массива $$$c$$$, если $$$d$$$ может быть получен из $$$c$$$ удалением нескольких (возможно, ни одного или всех) элементов из начала и нескольких (возможно, ни одного или всех) элементов из конца.</p>"},"inSpecsHtml":{"en":"<div class=\"section-title\">Input</div><p>The first line contains a single integer $$$t$$$ ($$$1 \\le t \\le 10\\,000$$$)&nbsp;— the number of test cases.</p><p>The first line of each test case contains a single integer $$$n$$$ ($$$1 \\le n \\le 10^5$$$).</p><p>The second line of each test case contains $$$n$$$ integers $$$a_1, a_2, \\ldots, a_n$$$ ($$$1 \\le a_i \\le 10^5$$$).</p><p>It is guaranteed that the sum of $$$n$$$ over all test cases doesn't exceed $$$10^5$$$.</p>","ru":"<div class=\"section-title\">Входные данные</div><p>Первая строка содержит одно целое число $$$t$$$ ($$$1 \\le t \\le 10\\,000$$$)&nbsp;— количество наборов входных данных.</p><p>Первая строка каждого набора входных данных содержит одно целое число $$$n$$$ ($$$1 \\le n \\le 10^5$$$).</p><p>Вторая строка каждого набора входных данных содержит $$$n$$$ целых чисел $$$a_1, a_2, \\ldots, a_n$$$ ($$$1 \\le a_i \\le 10^5$$$).</p><p>Гарантируется, что сумма $$$n$$$ по всем наборам входных данных не превышает $$$10^5$$$.</p>"},"outSpecsHtml":{"en":"<div class=\"section-title\">Output</div><p>For each test case, print a single integer &nbsp;— the sum of <span class=\"tex-font-style-it\">extreme values</span> of all subarrays of $$$a$$$ modulo $$$998\\,244\\,353$$$.</p>","ru":"<div class=\"section-title\">Выходные данные</div><p>Для каждого набора входных данных выведите одно целое число &nbsp;— сумму <span class=\"tex-font-style-it\">экстремальных значений</span> по всем подмассивам $$$a$$$, по модулю $$$998\\,244\\,353$$$.</p>"},"noteHtml":{"en":"<div class=\"section-title\">Note</div><p>Let $$$f(l, r)$$$ denote the <span class=\"tex-font-style-it\">extreme value</span> of $$$[a_l, a_{l+1}, \\ldots, a_r]$$$.</p><p>In the first test case, </p><ul> <li> $$$f(1, 3) = 3$$$, because YouKn0wWho can perform the following operations on the subarray $$$[5, 4, 3]$$$ (the newly inserted elements are underlined):<p>$$$[5, 4, 3] \\rightarrow [\\underline{3}, \\underline{2}, 4, 3] \\rightarrow [3, 2, \\underline{2}, \\underline{2}, 3] \\rightarrow [\\underline{1}, \\underline{2}, 2, 2, 2, 3]$$$;</p></li><li> $$$f(1, 2) = 1$$$, because $$$[5, 4] \\rightarrow [\\underline{2}, \\underline{3}, 4]$$$;</li><li> $$$f(2, 3) = 1$$$, because $$$[4, 3] \\rightarrow [\\underline{1}, \\underline{3}, 3]$$$;</li><li> $$$f(1, 1) = f(2, 2) = f(3, 3) = 0$$$, because they are already non-decreasing. </li></ul><p>So the total sum of <span class=\"tex-font-style-it\">extreme values</span> of all subarrays of $$$a = 3 + 1 + 1 + 0 + 0 + 0 = 5$$$.</p>","ru":"<div class=\"section-title\">Примечание</div><p>Пусть $$$f(l, r)$$$ обозначает <span class=\"tex-font-style-it\">экстремальное значение</span> в подмассиве $$$[a_l, a_{l+1}, \\ldots, a_r]$$$.</p><p>В первом наборе входных данных:</p><ul> <li> $$$f(1, 3) = 3$$$, потому что YouKn0wWho может выполнить следующие операции над подмассивом $$$[5, 4, 3]$$$ (новые вставленные элементы подчеркнуты):<p>$$$[5, 4, 3] \\rightarrow [\\underline{3}, \\underline{2}, 4, 3] \\rightarrow [3, 2, \\underline{2}, \\underline{2}, 3] \\rightarrow [\\underline{1}, \\underline{2}, 2, 2, 2, 3]$$$;</p></li><li> $$$f(1, 2) = 1$$$, потому что $$$[5, 4] \\rightarrow [\\underline{2}, \\underline{3}, 4]$$$;</li><li> $$$f(2, 3) = 1$$$, потому что $$$[4, 3] \\rightarrow [\\underline{1}, \\underline{3}, 3]$$$;</li><li> $$$f(1, 1) = f(2, 2) = f(3, 3) = 0$$$, потому что они уже неубывающие. </li></ul><p>Таким образом, общая сумма <span class=\"tex-font-style-it\">экстремальных значений</span> всех подмассивов $$$a = 3 + 1 + 1 + 0 + 0 + 0 = 5$$$.</p>"},"sampleTestcases":[{"id":1635604521947,"input":"4\n3\n5 4 3\n4\n3 2 1 4\n1\n69\n8\n7264 40515 28226 92776 35285 21709 75124 48163\n","output":"5\n9\n0\n117\n"}],"submitUrl":"https://codeforces.com/contest/1603/submit","language":"c++","isPartOfContest":true}